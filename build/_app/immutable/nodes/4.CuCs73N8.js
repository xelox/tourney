import"../chunks/DsnmJJEf.js";import"../chunks/ByTUjnXn.js";import{h as X,a2 as j,b as S,d as k,r as x,a5 as P,a3 as C,x as v,B as g,a as B,a4 as q,c as Y,f as Z,A as d,Q as b,az as $,S as ee}from"../chunks/CVDsBalB.js";import{F as pe}from"../chunks/BQu2-JPA.js";import{t as ve,s as D,a as me,p as we}from"../chunks/CnKtCqUK.js";import{i as z}from"../chunks/Dek8J-GH.js";import{s as be,o as Be,a as Ae,e as Ee}from"../chunks/DZBSwm0Q.js";import{i as N}from"../chunks/SklheZ_d.js";import{p as h}from"../chunks/C2nT3uSY.js";function te(t,r,n,e,i,l){var s=t.__className;if(X||s!==n||s===void 0){var o=ve(n,e,l);(!X||o!==t.getAttribute("class"))&&(o==null?t.removeAttribute("class"):t.className=o),t.__className=n}else if(l&&i!==l)for(var a in l){var f=!!l[a];(i==null||f!==!!i[a])&&t.classList.toggle(a,f)}return l}const ie=25,ke=100,ae=90,le=90;function re(t){console.log("making tree from list:",t);let r=0;const n=()=>(r++,r);if(t.length==0)return{root:{id:0},depth:1,base:1};let e=t.map(a=>({w:a,id:n()}));const i=Math.pow(2,Math.ceil(Math.log2(t.length))),l=i;for(;e.length<i;)e.push({id:n()});let s=1;for(;e.length>1;){s++;const a=[];for(let f=0;f<e.length;f+=2){const m=e[f],_=e[f+1],c={left:m,right:_,id:n()};a.push(c)}e=a}const o=H(e[0]);if(!o)throw"no tree was made";return{root:o,depth:s,base:l}}function H(t){if(!t)return null;if(!t.left&&!t.right)return t.w&&"tag"in t.w?t:null;const r=H(t.left),n=H(t.right);return!r&&!n?null:r?n?{w:t.w,left:r,right:n,id:t.id}:r:n}function se(t,r,n=!1){if(!t.left)return{top_half:0,bottom_half:0};if(r>=4&&!n)return se(t.left,r-1,!0);const e=Math.pow(2,r-1)*ie;let i=e,l=0,s=t.left;for(;s;)s=s.left,l+=i,i/=2;i=e;let o=0,a=t.right;for(;a;)a=a.right,o+=i,i/=2;return console.log("computed height:",o),{top_half:l,bottom_half:o}}function ne(t){let r=1,n=t.left;for(;n;)n=n.left,r+=1;return r}var xe=S('<main class="svelte-p5o8md"><p class="svelte-p5o8md"> </p> <div class="svelte-p5o8md"></div></main>');function ye(t,r){j(r,!1);let n=h(r,"player",8,void 0);console.log("creating player:",n()),z();var e=xe(),i=k(e),l=k(i,!0);x(i);var s=P(i,2);x(e),C(()=>{be(l,(g(n()),v(()=>n()?.tag??"TBC"))),D(s,`background-image: url(${g(n()),v(()=>n()?.image_url??"/tourney/placeholder.png")??""});`)}),B(t,e),q()}var Me=S("<div></div>"),Ne=S('<main class="svelte-184e2k5"><!> <div><!> <!> <!></div></main>');function T(t,r){j(r,!1);let n=h(r,"is_root",8,!1),e=h(r,"current_node",12),i=h(r,"parent_node",12,void 0),l=h(r,"eventBus",8),s=h(r,"is_upper",8,!1),o=h(r,"is_lower",8,!1),a=h(r,"is_right_half",8,!0),f=h(r,"depth",8),m=h(r,"v_delta",8,0),_=h(r,"is_first_split",8,!1),c=n()&&f()>=4;const y=()=>{e(e())};Be(()=>{l().addEventListener("refresh",y)}),Ae(()=>{l().removeEventListener("refresh",y)});const I=Math.pow(2,f()-1)*ie;function oe(){if(i()==null||e()==null)throw"nuh uh";i(i().w=e(),!0),l().dispatchEvent(new CustomEvent("refresh"))}function Q(p){if(p.w){if("tag"in p.w)return p.w;if(p.w!==void 0)return Q(p.w)}}function R(){if(i()===void 0||i().w===void 0)return!1;if("id"in i().w)return i().w.id==e()?.id}z();var V=Y(),ue=Z(V);{var _e=p=>{var M=Ne(),W=k(M);{var fe=u=>{var w=Me();let A;C(O=>{A=te(w,1,"connector svelte-184e2k5",null,A,O),D(w,`height: ${_()?0:I*2}px;`)},[()=>({winner_class:R(),lower_connector:o()&&!a()&&!_(),upper_connector:s()&&!a()&&!_(),lower_connector_right:o()&&a()&&!_(),upper_connector_right:s()&&a()&&!_(),split_connector_left:s()&&_(),split_connector_right:o()&&_()})]),B(u,w)};N(W,u=>{n()||u(fe)})}var L=P(W,2);let J;var K=k(L);{let u=b(()=>(g(e()),v(()=>Q(e()))));ye(K,{get player(){return d(u)}})}var U=P(K,2);{var ce=u=>{{let w=b(()=>f()-1),A=b(()=>c?0:-I);T(u,{get current_node(){return g(e()),v(()=>e().left)},get parent_node(){return e()},get depth(){return d(w)},get v_delta(){return d(A)},is_upper:!0,get is_right_half(){return a()},get is_first_split(){return c},get eventBus(){return l()}})}};N(U,u=>{g(e()),v(()=>e().left)&&u(ce)})}var he=P(U,2);{var de=u=>{var w=Y(),A=Z(w);{var O=E=>{{let F=b(()=>(g(ne),g(e()),v(()=>ne(e().right)))),G=b(()=>!c||!0);T(E,{get current_node(){return g(e()),v(()=>e().right)},get parent_node(){return e()},get depth(){return d(F)},v_delta:0,get is_lower(){return d(G)},get is_first_split(){return c},is_right_half:!1,get eventBus(){return l()}})}},ge=E=>{{let F=b(()=>f()-1),G=b(()=>!c||!0);T(E,{get current_node(){return g(e()),v(()=>e().right)},get parent_node(){return e()},get depth(){return d(F)},get v_delta(){return I},get is_lower(){return d(G)},get is_right_half(){return a()},get eventBus(){return l()}})}};N(A,E=>{c?E(O):E(ge,!1)})}B(u,w)};N(he,u=>{g(e()),v(()=>e().right)&&u(de)})}x(L),x(M),C(u=>{D(M,`top: 0; 
		left: 0; 
		transform: translate(${n()?0:ke*(a()?-1:1)*(_()?1.5:1)}px, ${m()??""}px); 
		width: ${le}px;
		height: ${ae}px;
		`),J=te(L,1,"border_div svelte-184e2k5",null,J,u)},[()=>({root_class:n(),winner_class:R(),is_lower_left:o()&&!a()&&!_(),is_upper_left:s()&&!a()&&!_(),is_lower_right:o()&&a()&&!_(),is_upper_right:s()&&a()&&!_()})]),Ee("click",M,me(function(...u){(n()?null:oe)?.apply(this,u)})),B(p,M)};N(ue,p=>{e()!=null&&p(_e)})}B(t,V),q()}var Pe=S('<main class="svelte-7j5bro"><!></main>');function Se(t,r){j(r,!1);const n=new EventTarget;let e=[],i=re(e),l=$(i.root),s=$(i.depth);we.subscribe(c=>{e=c;let y=re(c);ee(l,y.root),ee(s,y.depth)});const{top_half:o,bottom_half:a}=se(d(l),d(s)),f=a+o+ae;z();var m=Pe(),_=k(m);T(_,{get current_node(){return d(l)},is_root:!0,get eventBus(){return n},get depth(){return d(s)},get v_delta(){return o}}),x(m),C(()=>D(m,`width: ${le}px; height: ${f}px`)),B(t,m),q()}var Te=S('<main class="svelte-tv0rs3"><!> <!></main>');function qe(t){var r=Te(),n=k(r);Se(n,{});var e=P(n,2);pe(e),x(r),B(t,r)}export{qe as component};
