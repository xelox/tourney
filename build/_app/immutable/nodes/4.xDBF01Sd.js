import"../chunks/DsnmJJEf.js";import"../chunks/ByTUjnXn.js";import{h as X,a2 as H,b as S,d as k,r as x,a5 as P,a3 as C,x as m,B as w,a as B,a4 as q,c as Y,f as Z,A as d,Q as b,az as $,S as ee}from"../chunks/CVDsBalB.js";import{F as ge}from"../chunks/VaGNc8tQ.js";import{t as pe,s as D,a as ve,p as me}from"../chunks/CnKtCqUK.js";import{i as z}from"../chunks/Dek8J-GH.js";import{s as we,o as be,a as Be,e as Ae}from"../chunks/DZBSwm0Q.js";import{i as N}from"../chunks/SklheZ_d.js";import{p as h}from"../chunks/C2nT3uSY.js";function te(t,r,n,e,i,l){var s=t.__className;if(X||s!==n||s===void 0){var o=pe(n,e,l);(!X||o!==t.getAttribute("class"))&&(o==null?t.removeAttribute("class"):t.className=o),t.__className=n}else if(l&&i!==l)for(var a in l){var f=!!l[a];(i==null||f!==!!i[a])&&t.classList.toggle(a,f)}return l}const ne=25,Ee=100,ie=90,ae=90;function re(t){console.log("making tree from list:",t);let r=0;const n=()=>(r++,r);if(t.length==0)return{root:{id:0},depth:1,base:1};let e=t.map(a=>({w:a,id:n()}));const i=Math.pow(2,Math.ceil(Math.log2(t.length))),l=i;for(;e.length<i;)e.push({id:n()});let s=1;for(;e.length>1;){s++;const a=[];for(let f=0;f<e.length;f+=2){const p=e[f],_=e[f+1],c={left:p,right:_,id:n()};a.push(c)}e=a}const o=G(e[0]);if(!o)throw"no tree was made";return{root:o,depth:s,base:l}}function G(t){if(!t)return null;if(!t.left&&!t.right)return t.w&&"tag"in t.w?t:null;const r=G(t.left),n=G(t.right);return!r&&!n?null:r?n?{w:t.w,left:r,right:n,id:t.id}:r:n}function le(t,r,n=!1){if(!t.left)return{top_half:0,bottom_half:0};if(r>=4&&!n)return le(t.left,r-1,!0);const e=Math.pow(2,r-1)*ne;let i=e,l=0,s=t.left;for(;s;)s=s.left,l+=i,i/=2;i=e;let o=0,a=t.right;for(;a;)a=a.right,o+=i,i/=2;return console.log("computed height:",o),{top_half:l,bottom_half:o}}var ke=S('<main class="svelte-p5o8md"><p class="svelte-p5o8md"> </p> <div class="svelte-p5o8md"></div></main>');function xe(t,r){H(r,!1);let n=h(r,"player",8,void 0);console.log("creating player:",n()),z();var e=ke(),i=k(e),l=k(i,!0);x(i);var s=P(i,2);x(e),C(()=>{we(l,(w(n()),m(()=>n()?.tag??"TBC"))),D(s,(w(n()),m(()=>`background-image: url(${n()?.image_url});`)))}),B(t,e),q()}var ye=S("<div></div>"),Me=S('<main class="svelte-184e2k5"><!> <div><!> <!> <!></div></main>');function T(t,r){H(r,!1);let n=h(r,"is_root",8,!1),e=h(r,"current_node",12),i=h(r,"parent_node",12,void 0),l=h(r,"eventBus",8),s=h(r,"is_upper",8,!1),o=h(r,"is_lower",8,!1),a=h(r,"is_right_half",8,!0),f=h(r,"depth",8),p=h(r,"v_delta",8,0),_=h(r,"is_first_split",8,!1),c=n()&&f()>=4;const y=()=>{e(e())};be(()=>{l().addEventListener("refresh",y)}),Be(()=>{l().removeEventListener("refresh",y)});const I=Math.pow(2,f()-1)*ne;function se(){if(i()==null||e()==null)throw"nuh uh";i(i().w=e(),!0),l().dispatchEvent(new CustomEvent("refresh"))}function Q(g){if(g.w){if("tag"in g.w)return g.w;if(g.w!==void 0)return Q(g.w)}}function R(){if(i()===void 0||i().w===void 0)return!1;if("id"in i().w)return i().w.id==e()?.id}z();var V=Y(),oe=Z(V);{var ue=g=>{var M=Me(),W=k(M);{var _e=u=>{var v=ye();let A;C(O=>{A=te(v,1,"connector svelte-184e2k5",null,A,O),D(v,`height: ${_()?0:I*2}px;`)},[()=>({winner_class:R(),lower_connector:o()&&!a()&&!_(),upper_connector:s()&&!a()&&!_(),lower_connector_right:o()&&a()&&!_(),upper_connector_right:s()&&a()&&!_(),split_connector_left:s()&&_(),split_connector_right:o()&&_()})]),B(u,v)};N(W,u=>{n()||u(_e)})}var L=P(W,2);let J;var K=k(L);{let u=b(()=>(w(e()),m(()=>Q(e()))));xe(K,{get player(){return d(u)}})}var U=P(K,2);{var fe=u=>{{let v=b(()=>f()-1),A=b(()=>c?0:-I);T(u,{get current_node(){return w(e()),m(()=>e().left)},get parent_node(){return e()},get depth(){return d(v)},get v_delta(){return d(A)},is_upper:!0,get is_right_half(){return a()},get is_first_split(){return c},get eventBus(){return l()}})}};N(U,u=>{w(e()),m(()=>e().left)&&u(fe)})}var ce=P(U,2);{var he=u=>{var v=Y(),A=Z(v);{var O=E=>{{let j=b(()=>f()-1),F=b(()=>!c||!0);T(E,{get current_node(){return w(e()),m(()=>e().right)},get parent_node(){return e()},get depth(){return d(j)},v_delta:0,get is_lower(){return d(F)},get is_first_split(){return c},is_right_half:!1,get eventBus(){return l()}})}},de=E=>{{let j=b(()=>f()-1),F=b(()=>!c||!0);T(E,{get current_node(){return w(e()),m(()=>e().right)},get parent_node(){return e()},get depth(){return d(j)},get v_delta(){return I},get is_lower(){return d(F)},get is_right_half(){return a()},get eventBus(){return l()}})}};N(A,E=>{c?E(O):E(de,!1)})}B(u,v)};N(ce,u=>{w(e()),m(()=>e().right)&&u(he)})}x(L),x(M),C(u=>{D(M,`top: 0; 
		left: 0; 
		transform: translate(${n()?0:Ee*(a()?-1:1)*(_()?1.5:1)}px, ${p()??""}px); 
		width: ${ae}px;
		height: ${ie}px;
		`),J=te(L,1,"border_div svelte-184e2k5",null,J,u)},[()=>({root_class:n(),winner_class:R(),is_lower_left:o()&&!a()&&!_(),is_upper_left:s()&&!a()&&!_(),is_lower_right:o()&&a()&&!_(),is_upper_right:s()&&a()&&!_()})]),Ae("click",M,ve(function(...u){(n()?null:se)?.apply(this,u)})),B(g,M)};N(oe,g=>{e()!=null&&g(ue)})}B(t,V),q()}var Ne=S('<main class="svelte-7j5bro"><!></main>');function Pe(t,r){H(r,!1);const n=new EventTarget;let e=[],i=re(e),l=$(i.root),s=$(i.depth);me.subscribe(c=>{e=c;let y=re(c);ee(l,y.root),ee(s,y.depth)});const{top_half:o,bottom_half:a}=le(d(l),d(s)),f=a+o+ie;z();var p=Ne(),_=k(p);T(_,{get current_node(){return d(l)},is_root:!0,get eventBus(){return n},get depth(){return d(s)},get v_delta(){return o}}),x(p),C(()=>D(p,`width: ${ae}px; height: ${f}px`)),B(t,p),q()}var Se=S('<main class="svelte-16j1y0s"><!> <!></main>');function He(t){var r=Se(),n=k(r);Pe(n,{});var e=P(n,2);ge(e),x(r),B(t,r)}export{He as component};
